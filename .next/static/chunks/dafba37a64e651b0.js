(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,55688,e=>{"use strict";var t=e.i(29511),s=e.i(10641),r=e.i(58138),a=e.i(4421);function d(){let[e,d]=(0,r.useState)([]),[l,c]=(0,r.useState)(1),[n,o]=(0,r.useState)(0),[i,m]=(0,r.useState)(""),[x,h]=(0,r.useState)(""),[b,p]=(0,r.useState)(0),{user:u}=(0,a.useAuthStore)();u?.role.toLowerCase().trim(),(0,r.useEffect)(()=>{let e=setTimeout(()=>h(i),500);return()=>clearTimeout(e)},[i]);let j=(0,r.useCallback)(async()=>{let e=new URLSearchParams;e.set("limit","10"),e.set("offset",String(l)),x.trim()&&e.set("search",x.trim());let t=await fetch(`/api/goaml/reports?${e.toString()}`,{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"},cache:"no-store"}),s=await t.json();console.log("Fetched GOAML Reports:",s),s?.status?(d(s.data?.reports||[]),o(s.data?.total||0)):(d([]),o(0))},[l,x]);return(0,r.useEffect)(()=>{c(1)},[x]),(0,r.useEffect)(()=>{j()},[j,b]),(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,t.jsx)("h2",{className:"text-xl font-bold",children:"GOAML Reporting"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("button",{className:"px-3 py-2 rounded border text-sm",onClick:()=>p(e=>e+1),children:"Refresh"}),(0,t.jsx)(s.default,{href:"/dashboard/goaml-reporting/create",className:"px-3 py-2 rounded bg-blue-600 text-white text-sm",children:"+ Create New Report"})]})]}),(0,t.jsxs)("div",{className:"rounded border bg-white",children:[(0,t.jsx)("div",{className:"p-4 border-b",children:(0,t.jsx)("input",{type:"text",placeholder:"Search by customer name, ID, type, entity reference, or amount...",className:"p-2 border rounded w-full",value:i,onChange:e=>m(e.target.value)})}),(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"min-w-full",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{className:"bg-gray-50 text-left",children:[(0,t.jsx)("th",{className:"p-3 border-b",children:"Sl No."}),(0,t.jsx)("th",{className:"p-3 border-b",children:"Entity Reference No"}),(0,t.jsx)("th",{className:"p-3 border-b",children:"Customer Name"}),(0,t.jsx)("th",{className:"p-3 border-b",children:"Customer ID"}),(0,t.jsx)("th",{className:"p-3 border-b",children:"Customer Type"}),(0,t.jsx)("th",{className:"p-3 border-b",children:"Amount"}),(0,t.jsx)("th",{className:"p-3 border-b",children:"Created Date"}),(0,t.jsx)("th",{className:"p-3 border-b",children:"Actions"})]})}),(0,t.jsxs)("tbody",{children:[e.map((e,r)=>(0,t.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,t.jsx)("td",{className:"p-3 border-b",children:(l-1)*10+r+1}),(0,t.jsx)("td",{className:"p-3 border-b",children:e.entity_reference||e.entityRefNo||"-"}),(0,t.jsx)("td",{className:"p-3 border-b",children:e.customer_name||e.customerName||"-"}),(0,t.jsx)("td",{className:"p-3 border-b",children:e.customer_id||e.customerId||"-"}),(0,t.jsx)("td",{className:"p-3 border-b",children:(0,t.jsx)("span",{className:"bg-gray-100 text-gray-800 px-2 py-1 rounded text-xs",children:e.customer.customer_type||e.customer.customer_type||"-"})}),(0,t.jsx)("td",{className:"p-3 border-b",children:e.estimated_value??"-"}),(0,t.jsx)("td",{className:"p-3 border-b",children:e.created_at?new Date(e.created_at).toLocaleDateString():e.createdDate||"-"}),(0,t.jsx)("td",{className:"p-3 border-b",children:(0,t.jsxs)("div",{className:"flex gap-2",children:[u?.role!=="Analyst"&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.default,{href:`/dashboard/goaml-reporting/edit/${e.id}`,children:(0,t.jsx)("button",{className:"px-2 py-1 rounded border text-xs",children:"âœï¸"})}),(0,t.jsx)("button",{className:"px-2 py-1 rounded border text-xs",children:"ğŸ—‘ï¸"})]}),(0,t.jsx)(s.default,{href:`/dashboard/goaml-reporting/${e.id}`,className:"px-2 py-1 rounded border text-xs",children:"View"})]})})]},e.id||r)),0===e.length&&(0,t.jsx)("tr",{children:(0,t.jsx)("td",{className:"p-4 text-center text-sm text-gray-500",colSpan:8,children:"No reports found"})})]})]})}),(0,t.jsxs)("div",{className:"p-4 flex items-center justify-between",children:[(0,t.jsxs)("span",{className:"text-sm text-gray-600",children:["Showing ",(l-1)*10+1," to ",Math.min(10*l,n)," of ",n," entries"]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("button",{className:"px-2 py-1 rounded border text-sm",disabled:1===l,onClick:()=>c(l-1),children:"<"}),(0,t.jsx)("span",{className:"px-2 py-1 rounded bg-blue-600 text-white text-sm",children:l}),(0,t.jsx)("button",{className:"px-2 py-1 rounded border text-sm",disabled:e.length<10,onClick:()=>c(l+1),children:">"})]})]})]})]})}e.s(["default",()=>d])}]);