(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,56129,e=>{"use strict";var t=e.i(29511),s=e.i(58138),a=e.i(16755),r=e.i(74117);function l(){let e=(0,a.useRouter)(),l=(0,a.useParams)(),i=l?.id,{toast:d}=(0,r.useToast)(),[c,n]=(0,s.useState)(!0),[o,m]=(0,s.useState)(!1),[u,p]=(0,s.useState)([]),[h,x]=(0,s.useState)([]),[b,g]=(0,s.useState)(null),[v,j]=(0,s.useState)("all"),[y,_]=(0,s.useState)({customer_id:"",entity_reference:"",transaction_type:"",comments:"",item_type:"",item_make:"",description:"",disposed_value:"",status_comments:"",estimated_value:"",currency_code:""});(0,s.useEffect)(()=>{i&&e();async function e(){try{let e=await fetch(`/api/goaml/reports/${i}`,{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}}),t=await e.json();if(console.log("Fetched GOAML Report:",t),t?.status){let e=t.data.report;_({customer_id:e.customer_id?.toString()||"",entity_reference:e.entity_reference||"",transaction_type:e.transaction_type||"",comments:e.comments||"",item_type:e.item_type||"",item_make:e.item_make||"",description:e.description||"",disposed_value:e.disposed_value||"",status_comments:e.status_comments||"",estimated_value:e.estimated_value||"",currency_code:e.currency_code||""}),e.customer_id&&f(e.customer_id)}else d({title:"Error",description:t?.message||"Failed to load report"})}catch(e){console.error("Failed to fetch report",e),d({title:"Error",description:"Failed to load report"})}finally{n(!1)}}},[i]),(0,s.useEffect)(()=>{!async function(){try{let e=await fetch("/api/goaml/meta",{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}}),t=await e.json();t?.status&&x(t.data?.countries?.countries||[])}catch(e){console.error("Failed to fetch metadata",e)}}()},[]),(0,s.useEffect)(()=>{!async function(){try{let e=await fetch(`/api/onboarding/short-data-customers?customer_type=${v}`,{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}}),t=await e.json();t?.status&&p(t.data||[])}catch(e){console.error("Failed to fetch customers",e)}}()},[v]);let f=async e=>{try{let t=await fetch(`/api/onboarding/customers/${e}`),s=await t.json();if(s?.status){let t=s.data;t.id||(t.id=e),g(t)}}catch(e){console.error("Failed to fetch customer details",e)}},N=async()=>{if(!y.customer_id)return void d({title:"Required fields missing",description:"Please select a customer"});m(!0);try{let t={customer_id:Number(y.customer_id),entity_reference:y.entity_reference,transaction_type:y.transaction_type,comments:y.comments,item_type:y.item_type,item_make:y.item_make,description:y.description,disposed_value:y.disposed_value,status_comments:y.status_comments,estimated_value:y.estimated_value,currency_code:y.currency_code};console.log("Updating payload:",t);let s=await fetch(`/api/goaml/reports/${i}`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t)}),a=await s.json();a?.status?(d({title:"Success",description:a.message||"Report updated successfully"}),e.push("/dashboard/goaml-reporting")):d({title:"Error",description:a?.message||"Failed to update report"})}catch(e){console.error("Failed to update report",e),d({title:"Error",description:"An error occurred while updating the report"})}finally{m(!1)}};return c?(0,t.jsx)("div",{className:"p-6",children:"Loading..."}):(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Edit GOAML Report"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block mb-1",children:"Customer Type"}),(0,t.jsxs)("select",{className:"border p-2 rounded w-full",value:v,onChange:e=>j(e.target.value),children:[(0,t.jsx)("option",{value:"all",children:"All Customers"}),(0,t.jsx)("option",{value:"individual",children:"Individual"}),(0,t.jsx)("option",{value:"corporate",children:"Corporate"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block mb-1",children:"Pick Customer"}),(0,t.jsxs)("select",{className:"border p-2 rounded w-full",value:y.customer_id,onChange:async e=>{let t=e.target.value;(_({...y,customer_id:t}),t)?await f(parseInt(t)):g(null)},children:[(0,t.jsx)("option",{value:"",children:"Select Customer"}),u.map(e=>(0,t.jsx)("option",{value:e.id,children:e.name},e.id))]})]})]}),b&&(0,t.jsxs)("div",{className:"mb-4 border p-3 rounded",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Company Name"}),(0,t.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded border",children:b.corporate_detail?.company_name||b.name||"-"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Trade License Number"}),(0,t.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded border",children:b.corporate_detail?.trade_license_number||"-"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Contact Office Number"}),(0,t.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded border",children:b.contact_office_number||"-"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Company Address"}),(0,t.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded border",children:b.corporate_detail?.company_address||b.company_address||"-"})]})]}),b.individual_detail&&(0,t.jsxs)("div",{className:"mt-4",children:[(0,t.jsx)("h3",{className:"font-semibold mb-2",children:"Personal Information"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"First Name"}),(0,t.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded border",children:b.individual_detail.first_name})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Last Name"}),(0,t.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded border",children:b.individual_detail.last_name})]})]})]})]}),(0,t.jsxs)("div",{className:"mb-4 border p-3 rounded",children:[(0,t.jsx)("h3",{className:"font-semibold mb-4",children:"GOAML Report Details"}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Entity Reference"}),(0,t.jsx)("input",{className:"border p-2 rounded w-full",value:y.entity_reference,onChange:e=>_({...y,entity_reference:e.target.value})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Transaction Type"}),(0,t.jsxs)("select",{className:"border p-2 rounded w-full",value:y.transaction_type,onChange:e=>_({...y,transaction_type:e.target.value}),children:[(0,t.jsx)("option",{value:"",children:"Select a transaction type"}),(0,t.jsx)("option",{value:"sale",children:"Sale"}),(0,t.jsx)("option",{value:"purchase",children:"Purchase"})]})]})]}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Comments"}),(0,t.jsx)("input",{className:"border p-2 rounded w-full",value:y.comments,onChange:e=>_({...y,comments:e.target.value})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Item Make"}),(0,t.jsx)("input",{className:"border p-2 rounded w-full",value:y.item_make,onChange:e=>_({...y,item_make:e.target.value})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Item Type"}),(0,t.jsxs)("select",{className:"border p-2 rounded w-full",value:y.item_type,onChange:e=>_({...y,item_type:e.target.value}),children:[(0,t.jsx)("option",{value:"",children:"Select an item type"}),(0,t.jsx)("option",{value:"new",children:"New"}),(0,t.jsx)("option",{value:"old",children:"Old"})]})]})]}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,t.jsx)("textarea",{className:"border p-2 rounded w-full",rows:3,value:y.description,onChange:e=>_({...y,description:e.target.value})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Disposed Value"}),(0,t.jsx)("input",{type:"number",className:"border p-2 rounded w-full",value:y.disposed_value,onChange:e=>_({...y,disposed_value:e.target.value})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status Comments"}),(0,t.jsx)("input",{className:"border p-2 rounded w-full",value:y.status_comments,onChange:e=>_({...y,status_comments:e.target.value})})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Estimated Value"}),(0,t.jsx)("input",{type:"number",className:"border p-2 rounded w-full",value:y.estimated_value,onChange:e=>_({...y,estimated_value:e.target.value})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Currency Code"}),(0,t.jsxs)("select",{className:"border p-2 rounded w-full",value:y.currency_code,onChange:e=>_({...y,currency_code:e.target.value}),children:[(0,t.jsx)("option",{value:"",children:"Select currency code..."}),h.map(e=>(0,t.jsx)("option",{value:e.currency,children:e.currency},e.id))]})]})]})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("button",{className:"px-3 py-2 rounded bg-blue-600 text-white text-sm disabled:opacity-60",onClick:N,disabled:o,children:o?"Updating...":"Update Report"}),(0,t.jsx)("button",{className:"px-3 py-2 rounded border text-sm",onClick:()=>e.push("/dashboard/goaml-reporting"),children:"Cancel"})]})]})}e.s(["default",()=>l])}]);