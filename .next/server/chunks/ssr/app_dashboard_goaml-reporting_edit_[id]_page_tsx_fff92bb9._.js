module.exports=[7331,a=>{"use strict";var b=a.i(64781),c=a.i(89982),d=a.i(8490),e=a.i(70246);function f(){let a=(0,d.useRouter)(),f=(0,d.useParams)(),g=f?.id,{toast:h}=(0,e.useToast)(),[i,j]=(0,c.useState)(!0),[k,l]=(0,c.useState)(!1),[m,n]=(0,c.useState)([]),[o,p]=(0,c.useState)([]),[q,r]=(0,c.useState)(null),[s,t]=(0,c.useState)("all"),[u,v]=(0,c.useState)({customer_id:"",entity_reference:"",transaction_type:"",comments:"",item_type:"",item_make:"",description:"",disposed_value:"",status_comments:"",estimated_value:"",currency_code:""});(0,c.useEffect)(()=>{g&&a();async function a(){try{let a=await fetch(`/api/goaml/reports/${g}`,{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}}),b=await a.json();if(console.log("Fetched GOAML Report:",b),b?.status){let a=b.data.report;v({customer_id:a.customer_id?.toString()||"",entity_reference:a.entity_reference||"",transaction_type:a.transaction_type||"",comments:a.comments||"",item_type:a.item_type||"",item_make:a.item_make||"",description:a.description||"",disposed_value:a.disposed_value||"",status_comments:a.status_comments||"",estimated_value:a.estimated_value||"",currency_code:a.currency_code||""}),a.customer_id&&w(a.customer_id)}else h({title:"Error",description:b?.message||"Failed to load report"})}catch(a){console.error("Failed to fetch report",a),h({title:"Error",description:"Failed to load report"})}finally{j(!1)}}},[g]),(0,c.useEffect)(()=>{!async function(){try{let a=await fetch("/api/goaml/meta",{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}}),b=await a.json();b?.status&&p(b.data?.countries?.countries||[])}catch(a){console.error("Failed to fetch metadata",a)}}()},[]),(0,c.useEffect)(()=>{!async function(){try{let a=await fetch(`/api/onboarding/short-data-customers?customer_type=${s}`,{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}}),b=await a.json();b?.status&&n(b.data||[])}catch(a){console.error("Failed to fetch customers",a)}}()},[s]);let w=async a=>{try{let b=await fetch(`/api/onboarding/customers/${a}`),c=await b.json();if(c?.status){let b=c.data;b.id||(b.id=a),r(b)}}catch(a){console.error("Failed to fetch customer details",a)}},x=async()=>{if(!u.customer_id)return void h({title:"Required fields missing",description:"Please select a customer"});l(!0);try{let b={customer_id:Number(u.customer_id),entity_reference:u.entity_reference,transaction_type:u.transaction_type,comments:u.comments,item_type:u.item_type,item_make:u.item_make,description:u.description,disposed_value:u.disposed_value,status_comments:u.status_comments,estimated_value:u.estimated_value,currency_code:u.currency_code};console.log("Updating payload:",b);let c=await fetch(`/api/goaml/reports/${g}`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(b)}),d=await c.json();d?.status?(h({title:"Success",description:d.message||"Report updated successfully"}),a.push("/dashboard/goaml-reporting")):h({title:"Error",description:d?.message||"Failed to update report"})}catch(a){console.error("Failed to update report",a),h({title:"Error",description:"An error occurred while updating the report"})}finally{l(!1)}};return i?(0,b.jsx)("div",{className:"p-6",children:"Loading..."}):(0,b.jsxs)("div",{className:"p-6",children:[(0,b.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Edit GOAML Report"}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block mb-1",children:"Customer Type"}),(0,b.jsxs)("select",{className:"border p-2 rounded w-full",value:s,onChange:a=>t(a.target.value),children:[(0,b.jsx)("option",{value:"all",children:"All Customers"}),(0,b.jsx)("option",{value:"individual",children:"Individual"}),(0,b.jsx)("option",{value:"corporate",children:"Corporate"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block mb-1",children:"Pick Customer"}),(0,b.jsxs)("select",{className:"border p-2 rounded w-full",value:u.customer_id,onChange:async a=>{let b=a.target.value;(v({...u,customer_id:b}),b)?await w(parseInt(b)):r(null)},children:[(0,b.jsx)("option",{value:"",children:"Select Customer"}),m.map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id))]})]})]}),q&&(0,b.jsxs)("div",{className:"mb-4 border p-3 rounded",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Company Name"}),(0,b.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded border",children:q.corporate_detail?.company_name||q.name||"-"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Trade License Number"}),(0,b.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded border",children:q.corporate_detail?.trade_license_number||"-"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Contact Office Number"}),(0,b.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded border",children:q.contact_office_number||"-"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Company Address"}),(0,b.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded border",children:q.corporate_detail?.company_address||q.company_address||"-"})]})]}),q.individual_detail&&(0,b.jsxs)("div",{className:"mt-4",children:[(0,b.jsx)("h3",{className:"font-semibold mb-2",children:"Personal Information"}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"First Name"}),(0,b.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded border",children:q.individual_detail.first_name})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Last Name"}),(0,b.jsx)("div",{className:"mt-1 p-2 bg-gray-50 rounded border",children:q.individual_detail.last_name})]})]})]})]}),(0,b.jsxs)("div",{className:"mb-4 border p-3 rounded",children:[(0,b.jsx)("h3",{className:"font-semibold mb-4",children:"GOAML Report Details"}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Entity Reference"}),(0,b.jsx)("input",{className:"border p-2 rounded w-full",value:u.entity_reference,onChange:a=>v({...u,entity_reference:a.target.value})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Transaction Type"}),(0,b.jsxs)("select",{className:"border p-2 rounded w-full",value:u.transaction_type,onChange:a=>v({...u,transaction_type:a.target.value}),children:[(0,b.jsx)("option",{value:"",children:"Select a transaction type"}),(0,b.jsx)("option",{value:"sale",children:"Sale"}),(0,b.jsx)("option",{value:"purchase",children:"Purchase"})]})]})]}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Comments"}),(0,b.jsx)("input",{className:"border p-2 rounded w-full",value:u.comments,onChange:a=>v({...u,comments:a.target.value})})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Item Make"}),(0,b.jsx)("input",{className:"border p-2 rounded w-full",value:u.item_make,onChange:a=>v({...u,item_make:a.target.value})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Item Type"}),(0,b.jsxs)("select",{className:"border p-2 rounded w-full",value:u.item_type,onChange:a=>v({...u,item_type:a.target.value}),children:[(0,b.jsx)("option",{value:"",children:"Select an item type"}),(0,b.jsx)("option",{value:"new",children:"New"}),(0,b.jsx)("option",{value:"old",children:"Old"})]})]})]}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),(0,b.jsx)("textarea",{className:"border p-2 rounded w-full",rows:3,value:u.description,onChange:a=>v({...u,description:a.target.value})})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Disposed Value"}),(0,b.jsx)("input",{type:"number",className:"border p-2 rounded w-full",value:u.disposed_value,onChange:a=>v({...u,disposed_value:a.target.value})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status Comments"}),(0,b.jsx)("input",{className:"border p-2 rounded w-full",value:u.status_comments,onChange:a=>v({...u,status_comments:a.target.value})})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Estimated Value"}),(0,b.jsx)("input",{type:"number",className:"border p-2 rounded w-full",value:u.estimated_value,onChange:a=>v({...u,estimated_value:a.target.value})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Currency Code"}),(0,b.jsxs)("select",{className:"border p-2 rounded w-full",value:u.currency_code,onChange:a=>v({...u,currency_code:a.target.value}),children:[(0,b.jsx)("option",{value:"",children:"Select currency code..."}),o.map(a=>(0,b.jsx)("option",{value:a.currency,children:a.currency},a.id))]})]})]})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("button",{className:"px-3 py-2 rounded bg-blue-600 text-white text-sm disabled:opacity-60",onClick:x,disabled:k,children:k?"Updating...":"Update Report"}),(0,b.jsx)("button",{className:"px-3 py-2 rounded border text-sm",onClick:()=>a.push("/dashboard/goaml-reporting"),children:"Cancel"})]})]})}a.s(["default",()=>f])}];

//# sourceMappingURL=app_dashboard_goaml-reporting_edit_%5Bid%5D_page_tsx_fff92bb9._.js.map